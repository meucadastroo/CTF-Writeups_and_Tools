<p>Olá pessoal!</p><p><br />Hoje estou aqui pra falar sobre a utilidade da ferramenta de debug que a grande maioria dos browsers disponibilizam para desenvolvedores. Essa ferramenta de depuração auxilia na análise de execução dos códigos que rodam no background da página e saber sobre ela pode ser muito útil pra descobrir o que exatamente um código está fazendo, além do que, pode lhe ajudar a conseguir algumas flags nos CTFs que envolvem <strong>JavaScript Ofuscado</strong>.</p><p>Estarei usando o Google Chrome como browser para mostrar o básico do debugger, pois o conteúdo em seu total é muito extenso, mas caso se interesse no assunto, a Google disponibiliza de fácil acesso seus manuais.</p><p>Então...vamos lá!</p><p>Para ter acesso ao debugger:</p><ul><li>Ative as ferramentas de desenvolvedor com F12 ou Cmd+Opt+I</li><li>Selecione a opção Sources no painel.</li></ul><p><img src="1.png" /></p><p>Feito isso você chegara nesse ponto da imagem acima e claramente é possível perceber que a janela é dividida e 3 partes.</p><ol><li>A <strong>zona Recursos</strong> (a esquerda) lista HTML, JavaScript, CSS e outros arquivos, incluindo imagens anexadas à página. As extensões do Chrome também podem aparecer aqui.</li><li>A <strong>zona de origem</strong> (no centro) mostra o código-fonte.</li><li>A <strong>zona de Informações e controle</strong> (a direita) é para depuração, nós vamos explorá-la em breve.</li></ol><p>Se olharmos primeiramente para a <strong>Zona de Recursos</strong> nota-se um <strong>index.html</strong>, e é o conteúdo desse arquivo que irei usar para exemplificar algumas funções da <strong>zona de Informações e controle</strong>.</p><p><img src="2.png" /></p><p>Após selecionar o <strong>index.html</strong> o conteúdo do mesmo é carregado na <strong>zona de origem</strong> e já podemos ver o seu código fonte, e é fácil perceber que há um código javascript e que o mesmo possui duas funções separadas, cada um dentro de suas tags <strong>&lt;script&gt;</strong>, porem ao carregar a página não é possível perceber nenhuma execução de código. </p><p>Mas será mesmo que nada está executando?</p><p>Para sabermos isso vamos olhar o código fonte estático (Ctrl+u) e compara-lo ao código dinâmico da guia <strong>Elements</strong>. </p><p><img src="3.png" /><br /></p><p>Na imagem acima é possível perceber a diferença entre o código fonte estático e o dinâmico na guia <strong>Elements</strong>, apenas olhando para a tag html <strong><em>&lt;title&gt;</em></strong>, ou seja...o javascript contido na <strong>index.html</strong> está alterando rapidamente o título da página dinamicamente.</p><p>Para vermos como isso acontece, vamos utilizar os <strong>breakpoints, </strong>que é um recurso da <strong>zona de origem</strong> e que após inserido o <strong>breakpoint</strong> ele irá aparecer também na <strong>zona de Informações e controle</strong>. E para inserirmos isso, basta ir na <strong>zona de origem </strong>e clicar no numero da linha desejada e pronto, <strong>breakpoint</strong> inserido. E você pode inserir quantos <strong>breakpoints</strong> achar necessário.</p><p>Eu estarei inserindo dois, sendo um em cada termino de função.</p><p><img src="4.png" /></p><p>É fácil notar agora na imagem acima que a linha marcada na <strong>zona de origem</strong> ganha um realce de cor e que a agora na <strong>zona de Informações e controle </strong>aparece o <strong>breakpoint </strong>listado.</p><p>Recarregando a página F5 agora o código irá para no primeiro breakpoint que encontrar, seguindo o fluxo de execução do código. Que nesse caso é o <strong>breakpoint </strong>da segunda função.</p><p><img src="5.png" /></p><p>Agora nessa parte vamos precisar saber um pouco mais sobre a <strong>zona de Informações e controle,</strong> pois nela tem recursos para navegamos e seguirmos o fluxo de execução do código.</p><p>A <strong>zona de Informações e controle </strong>é dividida em várias partes, mas irei abordar apenas algumas delas, pois estas serão as necessárias para demonstração básica do uso do debugger.</p><p><img src="6.png" /></p><p>A primeira que irei falar é a parte <strong>0</strong>, que é a parte dos controles de rastreamento, que são:</p><ul><li><img src="7.png" /><strong> Continua a execução </strong>até o próximo <strong>breakpoint</strong> caso houver, tecla de atalho<strong> F8</strong></li><li><img src="8.png" /> Dá um passo<strong> (execute o próximo comando), </strong>mas não entra na função, tecla de atalho<strong> F10</strong></li><li><img src="9.png" /> Dá um passo, porem<strong> entra dentro da função, </strong>tecla de atalho<strong> F11</strong></li><li><img src="10.png" /> <strong>Continuar a execução até o final da função atual, </strong>tecla de atalho<strong> Shift+F1</strong></li></ul><p>A execução seria interrompida na última linha da função atual. Isso é útil quando acidentalmente inserimos uma chamada aninhada usando <img src="11.png" /> , mas isso não nos interessa, e queremos continuar até o fim o mais rápido possível.</p><ul><li><img src="12.png" /> Segue <strong>passo a passo</strong> a execução do código, tecla de atalho <strong>F9</strong></li><li><img src="13.png" /> <strong>Ativar / Desativar </strong>todos os <strong>breakpoints</strong>, tecla de atalho <strong>Ctrl+F8</strong></li><li><img src="14.png" /> Ativar / Desativar<strong> </strong>a<strong> pausa automática </strong>em caso de erro<strong>.</strong></li></ul><p>Quando ativado e as ferramentas do desenvolvedor estão abertas, um erro de script pausa automaticamente a execução. Então podemos analisar variáveis ​​para ver o que deu errado. Então, se nosso script morre com um erro, podemos abrir o depurador, ativar essa opção e recarregar a página para ver onde ela morre e qual é o contexto naquele momento.</p><p>Agora vou falar das partes de <strong>1 </strong>a<strong> 3 :</strong></p><ol><li><strong>Watch - mostra valores atuais para qualquer expressão.</strong></li></ol><p>Você pode clicar no sinal de mais + e inserir uma expressão. O depurador mostrará seu valor a qualquer momento, automaticamente recalculando-o no processo de execução.</p><ol><li><strong>Call Stack - mostra a cadeia de chamadas aninhadas.</strong></li></ol><p>No momento atual, o depurador está dentro da segunda função da index.html (sem função, portanto, é chamado de &quot;anônimo&quot;).</p><p>Se você clicar em um item de pilha (por exemplo, “anônimo”), o depurador vai para o código correspondente, e todas as suas variáveis ​​também podem ser examinadas.</p><ol><li><strong>Scope - variáveis ​​atuais.</strong></li></ol><p>Local mostra variáveis ​​de função locais. Você também pode ver seus valores destacados diretamente sobre a origem.</p><p>Global tem variáveis ​​globais (fora de qualquer função).</p><p>Agora que já sabemos os comandos básicos para controlar o fluxo de execução, vamos dar seguimento.</p><p><img src="15.png" /></p><p>Dando seguimento <strong>passo a passo</strong> é possível perceber na imagem acima que, em determinado ponto da <strong>segunda função </strong>(que está ofuscada)<strong>, </strong>é passado um valor <strong>title,</strong></p><p><img src="16.png" /></p><p>e seguidamente uma <strong>string</strong> para a <strong>primeira função </strong>chamada de <strong>r13 </strong>que nada mais é que a função <strong>rot13</strong> (<strong>Rot</strong>aciona 13 posições pra cada caractere passado),<strong> </strong>e é nessa função que feita a decodificação da <strong>string</strong> que se será o novo título da página.</p><p><img src="17.png" /></p><p><br /></p><p>E assim, com muita paciência e calma é possível analisar, entender e ver toda a execução do código sendo realizada na página, percebendo-se que são executadas <strong>duas funções</strong>, sendo que a <strong>segunda função </strong>chama a <strong>primeira</strong> para decodificar a <strong>string</strong> que será inserida no <strong>title</strong> por ela.</p><p>Não pretendo fazer aqui uma análise mais detalhada, pois a minha ideia com esse <strong>post </strong>é apenas lhe apresentar essa poderosa ferramenta presente na maioria dos navegadores atuais e dessa forma lhe incentivar a buscar aprender mais sobre o assunto. Porém não terminamos ainda, pois esse código oferece mais um segredinho que deixarei pra você desvendar.</p><p>Que a sua curiosidade seja seu guia, <strong>ok</strong>?</p><p>Desde de já agradeço pela atenção de quem ficou até o final desse conteúdo.</p><p><strong>“E que a força esteja com você!”</strong></p>